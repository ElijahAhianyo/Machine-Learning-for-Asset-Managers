# Machine Learning For Asset Managers Ch4 Optimal Clustering

[_Documentation generated by Documatic_](https://www.documatic.com)

<!---Documatic-section-Codebase Structure-start--->
## Codebase Structure

<!---Documatic-block-system_architecture-start--->
```mermaid
None
```
<!---Documatic-block-system_architecture-end--->

# #
<!---Documatic-section-Codebase Structure-end--->

<!---Documatic-section-Machine_Learning_for_Asset_Managers.ch4_optimal_clustering.clusterKMeansBase-start--->
## Machine_Learning_for_Asset_Managers.ch4_optimal_clustering.clusterKMeansBase

<!---Documatic-section-clusterKMeansBase-start--->
<!---Documatic-block-Machine_Learning_for_Asset_Managers.ch4_optimal_clustering.clusterKMeansBase-start--->
<details>
	<summary><code>Machine_Learning_for_Asset_Managers.ch4_optimal_clustering.clusterKMeansBase</code> code snippet</summary>

```python
def clusterKMeansBase(corr0, maxNumClusters=10, n_init=10, debug=False):
    corr0[corr0 > 1] = 1
    dist_matrix = ((1 - corr0.fillna(0)) / 2.0) ** 0.5
    silh_coef_optimal = pd.Series(dtype='float64')
    (kmeans, stat) = (None, None)
    maxNumClusters = min(maxNumClusters, int(np.floor(dist_matrix.shape[0] / 2)))
    print('maxNumClusters' + str(maxNumClusters))
    for init in range(0, n_init):
        for num_clusters in range(2, maxNumClusters + 1):
            kmeans_ = KMeans(n_clusters=num_clusters, n_init=10)
            kmeans_ = kmeans_.fit(dist_matrix)
            silh_coef = silhouette_samples(dist_matrix, kmeans_.labels_)
            stat = (silh_coef.mean() / silh_coef.std(), silh_coef_optimal.mean() / silh_coef_optimal.std())
            if np.isnan(stat[1]) or stat[0] > stat[1]:
                silh_coef_optimal = silh_coef
                kmeans = kmeans_
                if debug == True:
                    print(kmeans)
                    print(stat)
                    silhouette_avg = silhouette_score(dist_matrix, kmeans_.labels_)
                    print('For n_clusters =' + str(num_clusters) + 'The average silhouette_score is :' + str(silhouette_avg))
                    print('********')
    newIdx = np.argsort(kmeans.labels_)
    corr1 = corr0.iloc[newIdx]
    corr1 = corr1.iloc[:, newIdx]
    clstrs = {i: corr0.columns[np.where(kmeans.labels_ == i)[0]].tolist() for i in np.unique(kmeans.labels_)}
    silh_coef_optimal = pd.Series(silh_coef_optimal, index=dist_matrix.index)
    return (corr1, clstrs, silh_coef_optimal)
```
</details>
<!---Documatic-block-Machine_Learning_for_Asset_Managers.ch4_optimal_clustering.clusterKMeansBase-end--->
<!---Documatic-section-clusterKMeansBase-end--->

# #
<!---Documatic-section-Machine_Learning_for_Asset_Managers.ch4_optimal_clustering.clusterKMeansBase-end--->

[_Documentation generated by Documatic_](https://www.documatic.com)